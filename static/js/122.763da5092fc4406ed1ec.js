webpackJsonp([122],{dElG:function(t,e){},xclj:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("BO1k"),s=a.n(i),n=a("mvHQ"),l=a.n(n),o={name:"learnFromOthers",data:function(){return{loading:!0,edit:!1,formData:{fileType:"",fileName:"",fileDes:""},fileList:[],file:[],visiDialog:!1,types:[],copyArr:[],typeSelected:0,fileTypeId:"",optionData:[],value:"",tableData:[],currentPage:1,total:0,pageSize:10,pageList:[10,15,20],dataStatus:""}},inject:["globelDelet"],methods:{closess:function(t){t()},handleRemove:function(t,e){},handlePreview:function(t){},editClick:function(){var t=this;if(this.edit=!this.edit,!this.edit){var e=JSON.parse(l()(this.copyArr));e.shift();var a;a=e,this.$http.post("StatisticsAndAlarm/fileTypes/addOrEdit",a).then(function(e){0==e.data.code&&t.getfileType()})}},paginationChange:function(t){this.currentPage=t,this.searchKwFile()},paginationSizeChange:function(t){this.currentPage=1,this.pageSize=t,this.searchKwFile()},typeChange:function(t,e,a){"LI"!==a.srcElement.nodeName&&"SPAN"!==a.srcElement.nodeName||(this.typeSelected=e,this.fileTypeId=t.fileTypeId,this.searchKwFile())},typeDel:function(t){this.globelDelet("/StatisticsAndAlarm/fileTypes/deleteFileTypes",t,this.getfileType)},deletKnow:function(t){this.globelDelet("/StatisticsAndAlarm/knowledegBase/delete",t,this.searchKwFile)},addType:function(){var t=0,e=!0,a=!1,i=void 0;try{for(var n,l=s()(this.copyArr);!(e=(n=l.next()).done);e=!0){n.value.fileTypeName||t++}}catch(t){a=!0,i=t}finally{try{!e&&l.return&&l.return()}finally{if(a)throw i}}if(t)this.$yfMessage.warning("类型名称不能为空");else{var o={fileTypeName:"",knowledgeType:this.$route.query.id};this.copyArr.push(o)}},getfileType:function(){var t=this;this.$http.get("StatisticsAndAlarm/fileTypes/queryFileTypes",{params:{knowledgeType:this.$route.query.id}}).then(function(e){0==e.data.code&&(t.types=JSON.parse(l()(e.data.content.dataList)),t.copyArr=JSON.parse(l()(e.data.content.dataList)),t.copyArr.unshift({fileTypeName:"全部",fileTypeId:""}))})},searchKwFile:function(){var t=this;this.loading=!0,this.$http.get("StatisticsAndAlarm/knowledegBase/query",{params:{knowledgeType:this.$route.query.id,fileType:this.fileTypeId,pageNumber:this.currentPage,pageSize:this.pageSize}}).then(function(e){t.loading=!1,0==e.data.code&&(t.tableData=e.data.content.dataList,t.total=e.data.content.totalRecords,0==t.tableData.length?t.dataStatus="no":t.dataStatus="")})},fileChange:function(t,e){this.file=e},saveForm:function(){var t=this,e=new FormData;for(var a in this.file)e.append("file",this.file[a].raw);this.$http.post("/StatisticsAndAlarm/knowledegBase/add?fileType="+this.formData.fileType+"&fileName="+this.formData.fileName+"&fileDescribe="+this.formData.fileDes+"&knowledgeType="+this.$route.query.id,e,{headers:{"Content-Type":"multipart/form-data"}}).then(function(e){t.file=[],t.fileList=[],t.visiDialog=!1,t.searchKwFile()})}},created:function(){this.getfileType(),this.searchKwFile()},mounted:function(){},beforeDestroy:function(){},computed:{totalPageNumber:function(){return Math.ceil(this.total/this.pageSize)}},watch:{},components:{}},r={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"content-page"},[a("div",{staticClass:"page-header"},[t.edit?t._e():a("el-button",{staticStyle:{width:"auto"},on:{click:t.editClick}},[a("i",{staticClass:"iconfont icon-bianji"}),t._v("开启编辑\n    ")]),t._v(" "),t.edit?a("el-button",{staticStyle:{width:"auto"},attrs:{type:"delet"},on:{click:t.editClick}},[a("i",{staticClass:"iconfont icon-bianji"}),t._v("保存编辑\n    ")]):t._e(),t._v(" "),t.edit?a("el-button",{staticClass:"right",attrs:{type:"noticonsecondBtn"},on:{click:function(e){t.visiDialog=!0}}},[t._v("添 加")]):t._e()],1),t._v(" "),a("div",{staticClass:"sub-content"},[a("div",{staticClass:"type-list"},[a("ul",[a("el-scrollbar",{staticStyle:{height:"100%"}},[t._l(t.copyArr,function(e,i){return a("li",{key:i,class:{active:t.typeSelected===i},on:{click:function(a){return t.typeChange(e,i,a)}}},[a("span",{staticClass:"icon"}),t._v(" "),t.edit&&"全部"!==e.fileTypeName?t._e():a("span",[t._v(t._s(e.fileTypeName))]),t._v(" "),t.edit&&"全部"!==e.fileTypeName?a("el-input",{staticStyle:{width:"55px"},attrs:{placeholder:""},model:{value:e.fileTypeName,callback:function(a){t.$set(e,"fileTypeName",a)},expression:"v.fileTypeName"}}):t._e(),t._v(" "),"全部"!==e.fileTypeName&&t.edit?a("span",{staticClass:"right el-button--text",attrs:{type:"text"},on:{click:function(a){return a.stopPropagation(),t.typeDel(e.fileTypeId)}}},[t._v("删除")]):t._e()],1)}),t._v(" "),t.edit?a("button",{staticClass:"add-btn",on:{click:t.addType}},[a("i",{staticClass:"iconfont icon-tianjia"})]):t._e()],2)],1)]),t._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"table-content",attrs:{"element-loading-text":"加载中","element-loading-spinner":"loading-type-a","element-loading-background":"rgba(255, 255, 255, 1)",height:"100%"}},[a("el-scrollbar",{staticStyle:{height:"100%"}},[a("ul",t._l(t.tableData,function(e,i){return a("li",{key:i,staticStyle:{"padding-right":"12px"}},[a("i",{staticClass:"iconfont icon-ic-description-px"}),t._v(" "),a("span",{staticClass:"bold"},[t._v("【"),t._l(t.types,function(i,s){return e.fileType.fileTypeId===i.fileTypeId?a("span",{key:s},[t._v(t._s(i.fileTypeName))]):t._e()}),t._v("】")],2),t._v(" "),a("span",[t._v(t._s(e.fileName))]),t._v(" "),t.edit?a("span",{staticClass:"right bts el-button--text",on:{click:function(a){return t.deletKnow(e.knowledgeBaseId)}}},[t._v("删除")]):t._e(),t._v(" "),a("span",{staticClass:"right",staticStyle:{"margin-right":"12px"}},[t._v(t._s(e.filePublishTime))])])}),0),t._v(" "),a("yf-Datastatus",{directives:[{name:"show",rawName:"v-show",value:"no"==t.dataStatus,expression:"dataStatus == 'no'"}],attrs:{dataStatus:t.dataStatus}})],1)],1)]),t._v(" "),a("div",{staticClass:"table-pagination-wrap"},[a("el-pagination",{attrs:{"current-page":t.currentPage,"page-size":t.pageSize,"popper-class":"select-pagination-option",background:"",small:!0,"page-sizes":t.pageList,layout:"total, sizes, slot,->,prev, pager, next, jumper",total:t.total},on:{"size-change":t.paginationSizeChange,"current-change":t.paginationChange,"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e}},scopedSlots:t._u([{key:"default",fn:function(){return[a("span",{staticClass:"el-pagination__current"},[t._v("当前第"+t._s(t.currentPage)+"/"+t._s(t.totalPageNumber)+"页")])]},proxy:!0}])})],1),t._v(" "),a("el-dialog",{attrs:{visible:t.visiDialog,width:"360px",title:"添加","before-close":t.closess},on:{"update:visible":function(e){t.visiDialog=e}}},[a("div",{staticClass:"dialogcontent"},[a("div",{staticClass:"dialog-layout"},[a("ul",[a("li",[a("div",[a("span",{staticClass:"layoutspan"},[t._v("文件类型 : ")]),t._v(" \n                              "),a("div",{staticClass:"layoutBox",staticStyle:{width:"200px"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.formData.fileType,callback:function(e){t.$set(t.formData,"fileType",e)},expression:"formData.fileType"}},t._l(t.types,function(t){return a("el-option",{key:t.fileTypeId,attrs:{label:t.fileTypeName,value:t.fileTypeId}})}),1)],1)])]),t._v(" "),a("li",[a("span",{staticClass:"layoutspan"},[t._v("文件名称 : ")]),t._v(" \n                          "),a("div",{staticClass:"layoutBox",staticStyle:{width:"200px"}},[a("el-input",{attrs:{placeholder:"请输入"},model:{value:t.formData.fileName,callback:function(e){t.$set(t.formData,"fileName",e)},expression:"formData.fileName"}})],1)]),t._v(" "),a("li",[a("span",{staticClass:"layoutspan"},[t._v("文件描述 : ")]),t._v(" \n                          "),a("div",{staticClass:"layoutBox",staticStyle:{width:"200px"}},[a("el-input",{attrs:{placeholder:"请输入",type:"textarea",rows:3},model:{value:t.formData.fileDes,callback:function(e){t.$set(t.formData,"fileDes",e)},expression:"formData.fileDes"}})],1)]),t._v(" "),a("li",[a("span",{staticClass:"layoutspan"},[t._v("附件上传 : ")]),t._v(" \n                            "),a("div",{staticClass:"layoutBox",staticStyle:{width:"200px"}},[a("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{action:"/","on-change":t.fileChange,"on-preview":t.handlePreview,"on-remove":t.handleRemove,"file-list":t.fileList,"auto-upload":!1,"http-request":t.uploadFile}},[a("el-button",{attrs:{slot:"trigger"},slot:"trigger"},[a("i",{staticClass:"icon-shangchuan1 iconfont"}),t._v(" 选择文件")])],1)],1)])])])]),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"noticon"},on:{click:t.saveForm}},[t._v("保 存")]),t._v(" "),a("el-button",{attrs:{type:"noticonsecondBtn"},on:{click:function(e){t.visiDialog=!1}}},[t._v("关 闭")])],1)])],1)},staticRenderFns:[]};var c=a("VU/8")(o,r,!1,function(t){a("dElG")},"data-v-0241b9e6",null);e.default=c.exports}});
//# sourceMappingURL=122.763da5092fc4406ed1ec.js.map