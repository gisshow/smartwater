webpackJsonp([75],{UNQj:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});a("V+i5");var i=a("dwSH"),n=[{name:"日报",type:"date"},{name:"月报",type:"month"},{name:"年报",type:"year"}],s={shortcuts:[{text:"最近一周",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-6048e5),t.$emit("pick",[a,e])}},{text:"最近一个月",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-2592e6),t.$emit("pick",[a,e])}},{text:"最近三个月",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-7776e6),t.$emit("pick",[a,e])}}]},o={name:"singleStationReport",data:function(){return{reportLoading:!0,reportNoDataState:!1,dataTypeList:n,dataType:0,pickerOptions:s,dataValue:"",tableData:[],stationInfo:{},headcolumn:[],headtitle:"",statisDate:"",headtimetype:"date",loading:!0,fieldList:[]}},methods:{dataTypeToggle:function(t){this.dataType=t,0==t?this.headtimetype="date":1==t?this.headtimetype="month":2==t&&(this.headtimetype="year")},initTime:function(){"date"==this.headtimetype?this.dataValue=(new Date).format("yyyy-MM-dd"):"month"==this.headtimetype?this.dataValue=(new Date).format("yyyy-MM"):"year"==this.headtimetype&&(this.dataValue=(new Date).format("yyyy")),console.log(this.dataValue)},initTitle:function(){"date"==this.headtimetype?(this.headtitle=this.stationInfo.nodeName+"单站日报",this.statisDate=new Date(this.dataValue).format("yyyy-MM-dd")):"month"==this.headtimetype?(this.headtitle=this.stationInfo.nodeName+"单站月报",this.statisDate=new Date(this.dataValue).format("yyyy-MM")):"year"==this.headtimetype&&(this.headtitle=this.stationInfo.nodeName+"单站年报",this.statisDate=new Date(this.dataValue).format("yyyy"))},getTableData:function(){var t=this;this.loading=!0;var e="",a="";"date"==this.headtimetype?(e=new Date(this.dataValue).format("yyyy-MM-dd"),a="day"):"month"==this.headtimetype?(e=new Date(this.dataValue).format("yyyy-MM"),a="month"):"year"==this.headtimetype&&(e=new Date(this.dataValue).format("yyyy"),a="year"),this.initTitle(),this.$http.get("/StatisticsAndAlarm/dataReports/audioSingleReports",{params:{timeType:a,time:e,stationMn:this.stationInfo.nodeId}}).then(function(e){0==e.data.code&&(t.headcolumn=e.data.content.info,t.tableData=e.data.content.dataList),t.loading=!1}).catch(function(e){t.loading=!1})},exportExcel:function(){var t=this.$refs.table.$el.querySelector(".el-table__header"),e=this.headtitle,a="",n="";"date"==this.headtimetype?(a=new Date(this.dataValue).format("yyyy-MM-dd"),n="day"):"month"==this.headtimetype?(a=new Date(this.dataValue).format("yyyy-MM"),n="month"):"year"==this.headtimetype&&(a=new Date(this.dataValue).format("yyyy"),n="year"),this.fieldList=["time","level"];for(var s=0;s<this.headcolumn.length;s++)this.fieldList.push(this.headcolumn[s].code);var o={headerProp:this.fieldList.join(","),timeType:n,time:a,stationMn:this.stationInfo.nodeId};Object(i.a)(t,e,"","1","/StatisticsAndAlarm/exports/singleWaterQaulityReports",o)}},mounted:function(){},created:function(){this.initTime()},components:{},computed:{station:function(){return this.$store.state.stationInfo}},watch:{station:function(t){t.length>0&&(this.stationInfo=t[0],this.getTableData())}},destroy:function(){}},l={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"single-station-report-page"},[a("div",{staticClass:"secondary-page-mode"},[a("div",{staticClass:"secondary-toolbar"},[a("span",[t._v("数据类型：")]),t._v(" "),a("el-button-group",t._l(t.dataTypeList,function(e,i){return a("el-button",{key:i,class:{active:t.dataType===i},attrs:{size:"small",type:"primary",plain:""},on:{click:function(e){return t.dataTypeToggle(i)}}},[t._v(t._s(e.name))])}),1),t._v(" \n      "),a("span",[t._v("时间段：")]),t._v(" "),a("div",{staticClass:"layoutBox",staticStyle:{width:"242px"}},[a("el-date-picker",{attrs:{type:t.headtimetype,placeholder:"选择时间"},model:{value:t.dataValue,callback:function(e){t.dataValue=e},expression:"dataValue"}})],1),t._v(" \n      "),a("el-button",{on:{click:t.getTableData}},[a("i",{staticClass:"iconfont icon-sousuo"}),t._v("生成")]),t._v(" "),a("el-button",{attrs:{type:"delet"},on:{click:t.exportExcel}},[a("i",{staticClass:"iconfont icon-daochu"}),t._v("导出")])],1),t._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"currency-mode-wrap",attrs:{"element-loading-text":"加载中","element-loading-spinner":"loading-type-a","element-loading-background":"rgba(255, 255, 255, 1)"}},[a("el-scrollbar",{staticClass:"currency-mode-scroll"},[a("h4",{staticClass:"report-form-title"},[t._v(t._s(t.headtitle))]),t._v(" "),a("p",{staticClass:"report-form-subtitle"},[t._v(t._s(t.statisDate))]),t._v(" "),a("div",{staticClass:"report-table-wrap",staticStyle:{position:"relative"}},[a("el-table",{ref:"table",staticStyle:{width:"100%"},attrs:{data:t.tableData,border:""}},[a("el-table-column",{attrs:{type:"index",label:"序号",fixed:"",width:"50"}}),t._v(" "),a("el-table-column",{attrs:{prop:"time",label:"时间",fixed:"",width:"160"}}),t._v(" "),a("el-table-column",{attrs:{prop:"level",label:"水质类别",fixed:"",width:"160"}}),t._v(" "),t._l(t.headcolumn,function(t,e){return a("el-table-column",{key:e,attrs:{label:t.name}},[a("el-table-column",{attrs:{prop:t.code,label:t.unit}})],1)})],2)],1)])],1)])])},staticRenderFns:[]};var d=a("VU/8")(o,l,!1,function(t){a("lt6J")},"data-v-4d491758",null);e.default=d.exports},lt6J:function(t,e){}});
//# sourceMappingURL=75.7de2b949ff1c87910485.js.map