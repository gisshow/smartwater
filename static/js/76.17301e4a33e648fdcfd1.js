webpackJsonp([76],{HsLG:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("V+i5"),s=[{name:"日报",type:"hour"},{name:"月报",type:"day"},{name:"年报",type:"month"}],n={shortcuts:[{text:"最近一周",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-6048e5),t.$emit("pick",[a,e])}},{text:"最近一个月",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-2592e6),t.$emit("pick",[a,e])}},{text:"最近三个月",onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-7776e6),t.$emit("pick",[a,e])}}]},r={name:"multiStationPresentation",data:function(){return{reportLoading:!0,reportNoDataState:!1,dataTypeList:s,dataType:0,pickerOptions:n,dataValue:"",tableData:[],headtitle:"",evaluationdis:"",headcolumn:[],headtimetype:"date",htmlTitle:"页面导出PDF文件名",siteChecked:null}},methods:{setWidth:function(t){if(t){var e=t.length;return 14*e+20>104?14*e+20:104}},toWQLString:function(t){return"1"==t?"Ⅰ类":"2"==t?"Ⅱ类":"3"==t?"Ⅲ类":"4"==t?"Ⅳ类":"5"==t?"Ⅴ类":"6"==t?"劣Ⅴ类":""},exportPdf:function(){var t=s[this.dataType].type,e="",a="";if("date"==this.headtimetype)e=Object(i.a)(this.dataValue,"yyyy-MM-dd 00:00:00"),(n=this.convertDateFromString(e)).setDate(n.getDate()+1),a=Object(i.a)(n,"yyyy-MM-dd 00:00:00");else if("month"==this.headtimetype){e=Object(i.a)(this.dataValue,"yyyy-MM-01 00:00:00"),(n=this.convertDateFromString(e)).setMonth(n.getMonth()+1),a=Object(i.a)(n,"yyyy-MM-01 00:00:00")}else{var n;e=Object(i.a)(this.dataValue,"yyyy-01-01 00:00:00"),(n=this.convertDateFromString(e)).setFullYear(n.getFullYear()+1),a=Object(i.a)(n,"yyyy-01-01 00:00:00")}"area"==this.siteChecked.structureType?window.open("/waterenvapi/report/autoStationMuiltiBaogaoExport?queryType=station&areaIds="+this.siteChecked.id.toString()+"&statisType="+t+"&startTime="+e+"&endTime="+a):"river"==this.siteChecked.structureType?window.open("/waterenvapi/report/autoStationMuiltiBaogaoExport?queryType=station&riverIds="+this.siteChecked.id.toString()+"&statisType="+t+"&startTime="+e+"&endTime="+a):window.open("/waterenvapi/report/autoStationMuiltiBaogaoExport?queryType=station&equipdIds="+this.siteChecked.id.toString()+"&statisType="+t+"&startTime="+e+"&endTime="+a)},dataTypeToggle:function(t){this.dataType=t,0==t?this.headtimetype="date":1==t?this.headtimetype="month":2==t&&(this.headtimetype="year")},getSiteCheckedNodes:function(t){this.siteChecked=t,this.openPage=t.structureType,this.historicalDataSearch()},initTime:function(){this.dataValue=new Date},searchcolumn:function(){var t=this,e={equipIds:this.siteChecked.id?this.siteChecked.id.toString():""};"area"==this.siteChecked.structureType?e={areaIds:this.siteChecked.id.toString()}:"river"==this.siteChecked.structureType&&(e={riverIds:this.siteChecked.id.toString()}),this.$http.get("/waterenvapi/basic/stationRefProjects",{params:e}).then(function(e){var a=e.data;200===a.code&&(t.headcolumn=a.content.dataList)}).catch(function(t){})},checksiteinit:function(){var t=this,e=setInterval(function(){t.siteChecked&&(t.historicalDataSearch(),clearInterval(e))},100)},convertDateFromString:function(t){if(t)return new Date(t.replace(/-/,"/"))},initTitle:function(){var t="";if("date"==this.headtimetype)t=Object(i.a)(this.dataValue,"yyyy-MM-dd"),(e=this.convertDateFromString(t)).setMonth(e.getDate()+1),Object(i.a)(e,"yyyy-MM-dd");else if("month"==this.headtimetype){t=Object(i.a)(this.dataValue,"yyyy-MM"),(e=this.convertDateFromString(t)).setMonth(e.getMonth()+1),Object(i.a)(e,"yyyy-MM")}else{var e;t=Object(i.a)(this.dataValue,"yyyy"),(e=this.convertDateFromString(t)).setMonth(e.getFullYear()+1),Object(i.a)(e,"yyyy")}var a=this.siteChecked,n=s[this.dataType].name;this.headtitle=a.label+t+n+"表",this.htmlTitle=a.label+t+n+"表"},historicalDataSearch:function(){var t=this;this.reportLoading=!0,this.reportNoDataState=!1,this.searchcolumn(),this.initTitle();var e=s[this.dataType].type,a="",n="";if("date"==this.headtimetype)a=Object(i.a)(this.dataValue,"yyyy-MM-dd 00:00:00"),(r=this.convertDateFromString(a)).setDate(r.getDate()+1),n=Object(i.a)(r,"yyyy-MM-dd 00:00:00");else if("month"==this.headtimetype){a=Object(i.a)(this.dataValue,"yyyy-MM-01 00:00:00"),(r=this.convertDateFromString(a)).setMonth(r.getMonth()+1),n=Object(i.a)(r,"yyyy-MM-01 00:00:00")}else{var r;a=Object(i.a)(this.dataValue,"yyyy-01-01 00:00:00"),(r=this.convertDateFromString(a)).setFullYear(r.getFullYear()+1),n=Object(i.a)(r,"yyyy-01-01 00:00:00")}var o={equipdIds:this.siteChecked.id?this.siteChecked.id.toString():"",statisType:e,startTime:a,endTime:n,queryType:"station"};"area"==this.siteChecked.structureType?o={areaIds:this.siteChecked.id?this.siteChecked.id.toString():"",statisType:e,startTime:a,endTime:n,queryType:"station"}:"river"==this.siteChecked.structureType&&(o={riverIds:this.siteChecked.id?this.siteChecked.id.toString():"",statisType:e,startTime:a,endTime:n,queryType:"station"}),this.$http.get("/waterenvapi/report/autoStationMuiltiReport",{params:o}).then(function(e){var a=e.data;200===a.code&&(t.tableData=a.content.dataList,t.total=a.content.total,t.evaluationdis=a.content.info,0===a.content.dataList.length?t.reportNoDataState=!0:t.reportNoDataState=!1),t.reportLoading=!1}).catch(function(e){t.reportLoading=!1,t.reportNoDataState=!0})}},mounted:function(){this.initTime(),this.historicalDataSearch()},created:function(){this.$store.commit("setShowlefttree",!0),this.siteChecked=this.$store.state.stationInfo},computed:{station:function(){return this.$store.state.stationInfo}},watch:{station:function(t){this.siteChecked=t,this.historicalDataSearch()}}},o={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"single-station-report-page"},[a("div",{staticClass:"secondary-page-mode"},[a("div",{staticClass:"secondary-toolbar"},[a("span",[t._v("数据类型：")]),t._v(" "),a("el-button-group",t._l(t.dataTypeList,function(e,i){return a("el-button",{key:i,class:{active:t.dataType===i},attrs:{size:"small",type:"primary",plain:""},on:{click:function(e){return t.dataTypeToggle(i)}}},[t._v(t._s(e.name))])}),1),t._v(" \n      "),a("span",[t._v("时间段：")]),t._v(" "),a("div",{staticClass:"layoutBox",staticStyle:{width:"242px"}},[a("el-date-picker",{attrs:{type:t.headtimetype,placeholder:"选择时间"},model:{value:t.dataValue,callback:function(e){t.dataValue=e},expression:"dataValue"}})],1),t._v(" \n      "),a("el-button",{on:{click:t.historicalDataSearch}},[a("i",{staticClass:"iconfont icon-sousuo"}),t._v("生成")]),t._v(" "),a("el-button",{attrs:{type:"delet"},on:{click:t.exportPdf}},[a("i",{staticClass:"iconfont icon-daochu"}),t._v("导出")])],1),t._v(" "),a("div",{staticClass:"currency-mode-wrap"},[a("el-scrollbar",{staticClass:"currency-mode-scroll"},[a("h4",{staticClass:"report-form-title"},[t._v(t._s(t.headtitle))]),t._v(" "),a("p",{staticClass:"report-notes-text"},[t._v(t._s(t.evaluationdis)+"\n        ")]),a("div",{staticClass:"report-table-wrap",staticStyle:{position:"relative"}},[t.reportLoading?a("div",{staticClass:"loading-wrap"}):t._e(),t._v(" "),t.reportNoDataState?a("div",{staticClass:"no-data-wrap small no-data-table"},[a("p",[t._v("暂无数据")])]):t._e(),t._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,"empty-text":" ",border:""}},[a("el-table-column",{attrs:{type:"index",label:"序号",fixed:"",width:"50"}}),t._v(" "),a("el-table-column",{attrs:{prop:"name",fixed:"",label:"河道-站点名称","show-overflow-tooltip":!0,width:"230"}}),t._v(" "),a("el-table-column",{attrs:{label:"单因子评价",align:"center"}},[t._l(t.headcolumn,function(e,i){return a("el-table-column",{key:i,attrs:{label:e.projectName,width:t.setWidth(e.projectName),property:e.projectCode},scopedSlots:t._u([{key:"default",fn:function(i){return t._l(i.row.projects,function(i,s){return a("div",{key:s,staticClass:"data-table-cell"},[i.code==e.projectCode?a("span",[t._v(t._s(i.value)+"\n                          ")]):t._e()])})}}],null,!0)})}),t._v(" "),a("el-table-column",{attrs:{prop:"waterQualityLevel",label:"水质类别"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v("\n                    "+t._s(t.toWQLString(e.row.waterQualityLevel))+"\n                  ")])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"evaluation",label:"水质状况"}}),t._v(" "),a("el-table-column",{attrs:{prop:"primaryPollutant","show-overflow-tooltip":!0,width:"166",label:"主要污染物（超标倍数）"}})],2)],1)],1)])],1)])])},staticRenderFns:[]};var c=a("VU/8")(r,o,!1,function(t){a("KV0H")},"data-v-4d24d920",null);e.default=c.exports},KV0H:function(t,e){}});
//# sourceMappingURL=76.17301e4a33e648fdcfd1.js.map