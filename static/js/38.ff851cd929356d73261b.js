webpackJsonp([38],{"5Ab+":function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var i=e("V+i5"),s={shortcuts:[{text:"最近一周",onClick:function(t){var a=new Date,e=new Date;e.setTime(e.getTime()-6048e5),t.$emit("pick",[e,a])}},{text:"最近一个月",onClick:function(t){var a=new Date,e=new Date;e.setTime(e.getTime()-2592e6),t.$emit("pick",[e,a])}},{text:"最近三个月",onClick:function(t){var a=new Date,e=new Date;e.setTime(e.getTime()-7776e6),t.$emit("pick",[e,a])}}]},n=[{name:"实时",type:"minute"},{name:"日评价",type:"day"},{name:"周评价",type:"week"},{name:"月评价",type:"month"},{name:"季评价",type:"season"},{name:"年评价",type:"year"},{name:"自定义",type:"custom"}],r={name:"waterQualityEvaluationA",watch:{stationInfo:function(t){t.length>0&&(this.nodes={id:t[0].nodeId,label:t[0].nodeName},this.openPage=t[0].nodeType,this.init,"area"===this.openPage?this.$router.push("/colligateApplication/analysisReport/waterQualityEvaluationA"):"station"===this.openPage&&this.$router.push("/colligateApplication/analysisReport/waterQualityEvaluationD"))}},components:{mapComp2:e("YZTc").a},data:function(){return{openPage:"",nodes:{},waterLoading:!0,waterNoDataState:!1,trendLoading:!0,trendNoDataState:!1,dataValue:"",pickerOptions:s,dataType:0,dataTypeList:n,custom:!0,tableData:[],currentPage:1,total:0,pageSize:10,pageList:[10,15,20],myChartWater:"",myChart:"",evaluation:"",targetQualityLevel:"",computingMethod:"",timerange:"",analydetal:"",headtitle:"",mapInfo:[]}},computed:{totalPageNumber:function(){return Math.ceil(this.total/this.pageSize)},stationInfo:{get:function(){return this.$store.state.stationInfo}}},methods:{toWQLString:function(t){return"1"==t?"Ⅰ类":"2"==t?"Ⅱ类":"3"==t?"Ⅲ类":"4"==t?"Ⅳ类":"5"==t?"Ⅴ类":"6"==t?"劣Ⅴ类":""},dataTypeToggle:function(t,a){this.dataType=t,"custom"===a.type?this.custom=!1:(this.custom=!0,this.dataValue="");var e=this.dataTypeList[t].type,s=new Date,n=[];if("minute"==e)n.push(s,s);else if("day"==e){var r=new Date(Object(i.a)(s,"yyyy-MM-dd 00:00:00"));n.push(new Date(r.getTime()-864e5),s)}else if("week"==e){r=new Date(Object(i.a)(s,"yyyy-MM-dd 00:00:00"));n.push(new Date(r.getTime()-6048e5),s)}else if("month"==e){r=new Date(Object(i.a)(s,"yyyy-MM-01 00:00:00"));n.push(new Date(r.getTime()),s)}else if("season"==e){r=new Date(Object(i.a)(s,"yyyy-MM-01 00:00:00"));var l=new Date(Object(i.a)(new Date(r.getTime()-864e5),"yyyy-MM-01 00:00:00")),o=new Date(Object(i.a)(new Date(l.getTime()-864e5),"yyyy-MM-01 00:00:00"));n.push(new Date(o.getTime()),s)}else if("year"==e){r=new Date(Object(i.a)(s,"yyyy-01-01 00:00:00"));n.push(new Date(r.getTime()),s)}this.dataValue=n},allAreaStatus:function(){var t=this,a={queryType:"area",statisType:"minute",pareaIds:"7E15A844CCB34CCEB42AEE5ED38F5DFC"},e="/waterenvapi/realdatas/allAreaStatus",s=this.dataTypeList[this.dataType].type,n=Object(i.a)(this.dataValue[0],"yyyy-MM-dd hh:mm:ss"),r=Object(i.a)(this.dataValue[1],"yyyy-MM-dd hh:mm:ss");"minute"!=s&&(a={queryType:"basinn",statisType:"hour",pareaIds:"7E15A844CCB34CCEB42AEE5ED38F5DFC",startTime:n,endTime:r},e="/waterenvapi/realdatas/allAreaStatusRangeTime"),this.$http.get(e,{params:a}).then(function(a){var e=a.data;if(200===e.code){for(var i=e.content.dataList,s="",n=0;n<i.length;n++){var r=i[n];s=s+'"'+r.area+'":"'+t.getRgb16(r.waterQualityLevel)+'",'}s="{"+s.substring(0,s.length-1)+"}",t.$refs.cmap.quZColorObj=JSON.parse(s)}}).catch(function(t){})},getRgb16:function(t){var a=parseInt(t);return 1==a?"#00A1E4":2==a?"#00A1E4":3==a?"#24C768":4==a?"#E5CE10":5==a?"#FF7E00":6==a?"#FF0000":""},getTimeType:function(){var t=this.dataTypeList[this.dataType].type;return"minute"==t?"hour":"day"==t||"week"==t||"month"==t?"day":"month"==t||"season"==t||"year"==t?"month":"day"},searchData:function(){this.evaluate(),this.waterQualityProportionChart(),this.waterConcentrationChart(),this.stationDetail()},evaluate:function(){var t=this,a={queryType:"basinn",timeType:this.getTimeType(),startTime:Object(i.a)(this.dataValue[0],"yyyy-MM-dd hh:mm:ss"),endTime:Object(i.a)(this.dataValue[1],"yyyy-MM-dd hh:mm:ss"),queryCode:this.nodes.id};this.$http.get("/StatisticsAndAlarm/waterQualityEvaluation/waterQualitySummary",{params:a}).then(function(a){var e=a.data.content.info;0===a.data.code&&(t.evaluation=e.level,t.targetQualityLevel=e.airLevel,t.computingMethod=e.computingMethod,t.timerange=e.time,t.analydetal=e.message)}).catch(function(t){})},stationDetail:function(){var t=this,a={queryType:"basinn",timeType:this.getTimeType(),startTime:Object(i.a)(this.dataValue[0],"yyyy-MM-dd hh:mm:ss"),endTime:Object(i.a)(this.dataValue[1],"yyyy-MM-dd hh:mm:ss"),queryCode:this.nodes.id,pageSize:this.pageSize,pageNumber:this.currentPage};this.$http.get("/StatisticsAndAlarm/waterQualityEvaluation/qualityDetailsReports",{params:a}).then(function(a){0===a.data.code&&(t.tableData=a.data.content.dataList,t.total=a.data.content.totalRecords)}).catch(function(t){})},paginationChange:function(t){this.currentPage=t,this.stationDetail()},paginationSizeChange:function(t){this.currentPage=t,this.stationDetail()},waterQualityProportionChart:function(){var t=this;this.$nextTick(function(){t.myChartWater=t.$echarts.init(document.getElementById("water-quality-proportion-chart"))});var a={queryType:"basinn",timeType:this.getTimeType(),startTime:Object(i.a)(this.dataValue[0],"yyyy-MM-dd hh:mm:ss"),endTime:Object(i.a)(this.dataValue[1],"yyyy-MM-dd hh:mm:ss"),queryCode:this.nodes.id};this.$http.get("/StatisticsAndAlarm/waterQualityEvaluation/waterQualityPie",{params:a}).then(function(a){var e=a.data;if(0===e.code){var i=e.content.info.series[0].data,s=[];0===i.length?t.waterNoDataState=!0:t.waterNoDataState=!1;for(var n=0;n<i.length;n++){var r=i[n];s.push({name:r.name,value:r.value})}console.log(s);var l={color:["#00a1e4","#24c768","#e5ce10","#ff7e00","#ff0000"],title:{text:"河流断面水质比例图",x:"center",y:10},tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},legend:{bottom:10,itemGap:30,data:["I-II类","III类","IV类","V类","劣V类"]},series:[{name:"水质等级",type:"pie",radius:"70%",selectedMode:"single",label:{normal:{formatter:function(t){return 0!==t.percent?t.percent+"%\n"+t.name:""},fontSize:16,position:"inner",rich:{a:{fontSize:20,color:"#fff",lineHeight:34},b:{fontSize:14,color:"#fff"}}}},data:s}]};t.myChartWater.setOption(l)}t.waterLoading=!1}).catch(function(a){t.waterLoading=!1,t.waterNoDataState=!0})},waterConcentrationChart:function(){var t=this;this.$nextTick(function(){t.myChart=t.$echarts.init(document.getElementById("trend-change-chart"))});var a={queryType:"basinn",timeType:this.getTimeType(),startTime:Object(i.a)(this.dataValue[0],"yyyy-MM-dd hh:mm:ss"),endTime:Object(i.a)(this.dataValue[1],"yyyy-MM-dd hh:mm:ss"),queryCode:this.nodes.id};this.$http.get("/StatisticsAndAlarm/waterQualityEvaluation/waterQualityBarLine",{params:a}).then(function(a){var e=a.data;if(0===e.code){var i=e.content.info,s=i.xAxis,n=i.series[0].value,r=i.series[1].value;0===r.length?t.trendNoDataState=!0:t.trendNoDataState=!1;var l=t,o={color:["#2675d1"],title:{text:"水质排名详情",textStyle:{fontSize:16},subtext:"数据来源：小时数据",subtextStyle:{color:"#333"},x:"center",y:10},tooltip:{trigger:"axis",axisPointer:{type:"shadow"},formatter:function(t){var a=t[0].name+"<br>";for(var e in t)a+="<i class='circleEchart color"+t[e].value+"'></i>"+t[e].seriesName+": "+l.toWQLString(t[e].value)+"<br>";return a}},grid:{top:66,left:20,right:"4%",bottom:30,containLabel:!0},legend:{bottom:0,data:["目标水质"]},visualMap:{top:10,right:-100,pieces:[{value:1,color:"#00a1e4"},{value:2,color:"#00a1e4"},{value:3,color:"#24c768"},{value:4,color:"#e5ce10"},{value:5,color:"#ff7e00"},{value:6,color:"#ff0000"}],outOfRange:{color:"#999"}},xAxis:[{type:"category",data:s,axisTick:{show:!1},axisLine:{lineStyle:{color:"#c6d1de"}},axisLabel:{color:"#999"},splitLine:{show:!0}}],yAxis:[{type:"value",splitNumber:7,max:6,axisTick:{show:!1},axisLine:{lineStyle:{color:"#c6d1de"}},axisLabel:{color:"#999",formatter:function(t){var a=null;switch(t){case 0:a="";break;case 1:a="Ⅰ类";break;case 2:a="Ⅱ类";break;case 3:a="Ⅲ类";break;case 4:a="Ⅳ类";break;case 5:a="Ⅴ类";break;case 6:a="劣Ⅴ类"}return a}},splitLine:{show:!0}}],series:[{name:"断面实际水质",type:"bar",data:n,barWidth:20},{name:"目标水质",type:"line",symbolSize:10,lineStyle:{color:"#2675d1"},itemStyle:{borderColor:"#2675d1"},data:r}]};t.myChart.setOption(o)}t.trendLoading=!1}).catch(function(a){t.trendLoading=!1,t.trendNoDataState=!0})},init:function(){var t=new Date,a=[];a.push(t,t),this.dataValue=a,this.headtitle=this.nodes.label,this.searchData()}},created:function(){this.init()},mounted:function(){}},l={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"water-quality-evaluation-page"},[e("div",{staticClass:"secondary-scroll-content"},[e("h4",{staticClass:"statistical-analysis-title"},[t._v(" "+t._s(t.headtitle)+" ")]),t._v(" "),e("div",{staticClass:"secondary-toolbar"},[e("span",[t._v("时间段：")]),t._v(" "),e("el-button-group",t._l(t.dataTypeList,function(a,i){return e("el-button",{key:i,class:{active:t.dataType===i},attrs:{size:"small",type:"primary",plain:""},on:{click:function(e){return t.dataTypeToggle(i,a)}}},[t._v(t._s(a.name))])}),1),t._v(" "),e("div",{staticClass:"layoutBox",staticStyle:{width:"340px"}},[e("el-date-picker",{attrs:{type:"daterange",align:"right","unlink-panels":"","range-separator":"~","start-placeholder":"开始日期","end-placeholder":"结束日期",clearable:!1,format:"yyyy-MM-dd HH:mm","prefix-icon":"el-icon-date",disabled:t.custom,"picker-options":t.pickerOptions},model:{value:t.dataValue,callback:function(a){t.dataValue=a},expression:"dataValue"}})],1),t._v(" \n        "),e("el-button",{on:{click:t.searchData}},[e("i",{staticClass:"iconfont icon-shijiantai"}),t._v("评价1")])],1),t._v(" "),e("div",{staticClass:"currency-mode-wrap"},[t._m(0),t._v(" "),e("div",{staticClass:"secondary-mode-content"},[e("div",{staticClass:"normal-table-wrap"},[e("table",{staticClass:"normal-table"},[e("tr",[e("th",[t._v("水质现状")]),t._v(" "),e("td",[e("i",{staticClass:"sl-icon gradeC"}),t._v(" "+t._s(t.evaluation))]),t._v(" "),e("th",[t._v("水质目标")]),t._v(" "),e("td",[e("i",{staticClass:"sl-icon gradeB"}),t._v(" "+t._s(t.targetQualityLevel))])]),t._v(" "),e("tr",[e("th",[t._v("计算方法")]),t._v(" "),e("td",[t._v(t._s(t.computingMethod))]),t._v(" "),e("th",[t._v("数据时间")]),t._v(" "),e("td",[t._v(t._s(t.timerange))])])])]),t._v(" "),e("div",{staticClass:"statistical-analysis-text"},[e("p",[t._v(t._s(t.analydetal))])]),t._v(" "),e("div",{staticClass:"water-quality-analysis-row"},[e("div",{staticClass:"water-quality-map"},[e("h4",{staticClass:"water-quality-title"},[t._v("区域河流水质图")]),t._v(" "),e("mapComp2",{ref:"cmap",attrs:{mapType:"2",mapInfo:t.mapInfo}}),t._v(" "),e("div",{staticClass:"water-quality-map-legend"})],1),t._v(" "),e("div",{staticClass:"water-quality-proportion"},[t.waterLoading?e("div",{staticClass:"loading-wrap"}):t._e(),t._v(" "),t.waterNoDataState?e("div",{staticClass:"no-data-wrap small"},[e("p",[t._v("暂无数据")])]):t._e(),t._v(" "),e("div",{attrs:{id:"water-quality-proportion-chart"}})])]),t._v(" "),e("h4",{staticClass:"secondary-mode-title"},[e("i",{staticClass:"sl-icon block-icon"}),t._v(" "),e("span",[t._v(t._s(t.headtitle)+"断面水质详情")])]),t._v(" "),e("div",{staticClass:"water-quality-row"},[e("div",{staticClass:"water-quality-table-wrap"},[e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,border:""}},[e("el-table-column",{attrs:{prop:"name",label:"断面",align:"right"}}),t._v(" "),e("el-table-column",{attrs:{prop:"level",label:"水质等级"}}),t._v(" "),e("el-table-column",{attrs:{prop:"armLevel",label:"目标等级"}}),t._v(" "),e("el-table-column",{attrs:{prop:"river",label:"所属河流"}}),t._v(" "),e("el-table-column",{attrs:{prop:"areaName",label:"所属区域"}}),t._v(" "),e("el-table-column",{attrs:{prop:"keyPollution",label:"主要污染物"}}),t._v(" "),e("el-table-column",{attrs:{prop:"count",label:"数据条数"}})],1)],1),t._v(" "),e("div",{staticClass:"table-pagination-wrap"},[e("el-pagination",{attrs:{"current-page":t.currentPage,"page-size":t.pageSize,background:"",small:!0,"popper-class":"select-common-option","page-sizes":t.pageList,layout:"total, sizes, slot ,->,prev, pager, next, jumper",total:t.total},on:{"size-change":t.paginationSizeChange,"current-change":t.paginationChange,"update:currentPage":function(a){t.currentPage=a},"update:current-page":function(a){t.currentPage=a}}},[e("span",{staticClass:"el-pagination__current"},[t._v("当前第"+t._s(t.currentPage)+"/"+t._s(t.totalPageNumber)+"页")])])],1)]),t._v(" "),e("h4",{staticClass:"secondary-mode-title"},[e("i",{staticClass:"sl-icon block-icon"}),t._v(" "),e("span",[t._v(t._s(t.headtitle)+"断面水质详情排名")])]),t._v(" "),e("div",{staticClass:"water-chart-wrap"},[t.trendLoading?e("div",{staticClass:"loading-wrap"}):t._e(),t._v(" "),t.trendNoDataState?e("div",{staticClass:"no-data-wrap small"},[e("p",[t._v("暂无数据")])]):t._e(),t._v(" "),t._m(1),t._v(" "),e("div",{attrs:{id:"trend-change-chart"}})])])])])])},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("h4",{staticClass:"currency-mode-title"},[a("i",{staticClass:"mode-title-icon"}),this._v(" 水质评价\n         "),a("span",{staticClass:"mode-title-line"})])},function(){var t=this.$createElement,a=this._self._c||t;return a("ul",{staticClass:"color-line-list"},[a("li",{staticClass:"grade1"}),this._v(" "),a("li",{staticClass:"grade2"}),this._v(" "),a("li",{staticClass:"grade3"}),this._v(" "),a("li",{staticClass:"grade4"}),this._v(" "),a("li",{staticClass:"grade5"}),this._v(" "),a("li",{staticClass:"grade6"})])}]};var o=e("VU/8")(r,l,!1,function(t){e("d3z+")},"data-v-a9ea5b9a",null);a.default=o.exports},"d3z+":function(t,a){}});
//# sourceMappingURL=38.ff851cd929356d73261b.js.map